---
title: "Breast Cancer Project"
author: "Manuela Giansante, Liam Phan, MIcheal Bingler"
date: "2022-12-01"
output: html_document
---

```{r setup, include=FALSE, set.seed(1)}
knitr::opts_chunk$set(echo = TRUE,
                      cache = TRUE)
rm(list = ls())
```

```{r Libraries and functions, message=FALSE, warning= FALSE}

library(data.table)
library(summarytools)
library(dplyr)
library(ggplot2)
library(data.table) # fread
library(rbokeh) # visualization of data
library(summarytools) # ORIGINALSummary
library(adabag) # bagging and boosting
library(caret) # pre-processing
library(dplyr) # select, mutate_if
library(fastDummies) # dummy_cols
library(splitTools) # data partition
library(rpart) # classification tree
library(rpart.plot) # plot regression trees
library(DT) # datatable
library(corrplot) # corrplot
library(gains) # gain
library(randomForest) # randomForest
library(cluster) # hierarchical clustering
library(knitr) # kable
library(kableExtra) # kbl
library(ggplot2) # ggplot

```

```{r}
# Confusion matrix
draw_confusion_matrix <- function(cm) {
  layout(matrix(c(1,1,2)))
  par(mar=c(2,2,2,2))
  plot(c(100, 345), c(300, 450), type = "n", xlab="", ylab="", xaxt='n', yaxt='n')
  title('CONFUSION MATRIX', cex.main=2)}

  # create the matrix 
  rect(150, 430, 240, 370, col='#3F97D0')
  text(195, 435, 'No', cex=1.2)
  rect(250, 430, 340, 370, col='#F7AD50')
  text(295, 435, 'Yes', cex=1.2)
  text(125, 370, 'Predicted', cex=1.3, srt=90, font=2)
  text(245, 450, 'Actual', cex=1.3, font=2)
  rect(150, 305, 240, 365, col='#F7AD50')
  rect(250, 305, 340, 365, col='#3F97D0')
  text(140, 400, 'No', cex=1.2, srt=90)
  text(140, 335, 'Yes', cex=1.2, srt=90)

  # add in the cm results 
  res <- as.numeric(cm$table)
  text(195, 400, res[1], cex=1.6, font=2, col='white')
  text(195, 335, res[2], cex=1.6, font=2, col='white')
  text(295, 400, res[3], cex=1.6, font=2, col='white')
  text(295, 335, res[4], cex=1.6, font=2, col='white')

  # add in the specifics 
  plot(c(100, 0), c(100, 0), type = "n", xlab="", ylab="", main = "DETAILS", xaxt='n', yaxt='n')
  text(5, 85, names(cm$byClass[1]), cex=1.2, font=2)
  text(5, 70, round(as.numeric(cm$byClass[1]), 3), cex=1.2)
  text(23, 85, names(cm$byClass[2]), cex=1.2, font=2)
  text(23, 70, round(as.numeric(cm$byClass[2]), 3), cex=1.2)
  text(41, 85, names(cm$byClass[5]), cex=1.2, font=2)
  text(41, 70, round(as.numeric(cm$byClass[5]), 3), cex=1.2)
  text(59, 85, names(cm$byClass[6]), cex=1.2, font=2)
  text(59, 70, round(as.numeric(cm$byClass[6]), 3), cex=1.2)
  text(77, 85, names(cm$byClass[7]), cex=1.2, font=2)
  text(77, 70, round(as.numeric(cm$byClass[7]), 3), cex=1.2)
  text(95, 85, names(cm$byClass[8]), cex=1.2, font=2)
  text(95, 70, round(as.numeric(cm$byClass[8]), 3), cex=1.2)

  # add in the accuracy information 
  text(30, 35, names(cm$overall[1]), cex=1.5, font=2)
  text(30, 20, round(as.numeric(cm$overall[1]), 3), cex=1.4)
  text(70, 35, names(cm$overall[2]), cex=1.5, font=2)
  te
```

# Data Analysis

## Structure of Data

```{r Data reading}
ORIGINAL <- fread("data/Breast_Cancer/breast-cancer.csv")

# printing sumamry
print(dfSummary(ORIGINAL, valid.col = FALSE, graph.magnif = 0.75, plain.ascii = FALSE, html = TRUE, style ='grid', silent = TRUE), max.tbl.height = 300, width = 80, method = "render")
```

## Missing values

## Distribution of Data

## Correlation

```{r corrplot}
# select numeric variables
ORIGINAL_is.numeric <- ORIGINAL %>% 
  select_if(is.numeric)

ORIGINAL_heatmap <- round(cor(ORIGINAL_is.numeric, use = "complete.obs"), 1)
ORIGINAL_heatmap <- melt(ORIGINAL_heatmap)

#  corrplot
ggplot(ORIGINAL_heatmap, aes(x=Var1, y=Var2, fill=value)) +
  geom_tile()+
  scale_fill_gradient(low = "pink", high = "dark red")+
  labs(title="Correlation Heatmap",x="", y="")+
  geom_text(aes(x=Var1, y=Var2, label=value), color="white")+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1), plot.title = element_text(hjust=0.5))
```

# Data Preparation

## Transformation
```{r}

ORIGINAL[diagnosis == "M", c("diagnosis")] <- 1
ORIGINAL[diagnosis == "B", c("diagnosis")] <- 0

```


## Standardization

ORIGINAL
ORIGINAL center scale
ORIGINAL range

## Partitioning 
```{r}
splitting <- sample(1:3,size=nrow(ORIGINAL),replace=TRUE,prob=c(0.5,0.3,0.2))
Training <- ORIGINAL[splitting==1,]
Validation <- ORIGINAL[splitting==2,]
Test <- ORIGINAL[splitting==3,]

# Checking if proportions are right
Prop_Training <- (nrow(Training)/nrow(ORIGINAL))*100
Prop_Validation <- (nrow(Validation)/nrow(ORIGINAL))*100
Prop_Test <- (nrow(Test)/nrow(ORIGINAL))*100

# Print Proportion
paste("The Proportions are:", round(Prop_Training,2),"% In Training,",round(Prop_Validation,2),"% In Validation, and ",round(Prop_Test,2),"% In Test")

```

TRAINING 50, val 30, TEST 20

# Supervised Learning

## Logistic Regression

### big

### stepwise front / back / both / exhaustive search 

## Classification Tree

## K-Nearest Neighbor

## Neural Networks

## Discriminant Analysis

## Ensemble Methods

### bagging

### boosting

### rf

### majority vote -> combined

### average of models -> combined

## Comparision of Models

# Unsupervised Learning

## Cluster Analysis

# Conclusion



```{r Data reading}

ORIGINAL <- fread("data/Breast_Cancer/breast-cancer.csv")

# printing sumamry
print(ORIGINALSummary(ORIGINAL, valid.col = FALSE, graph.magnif = 0.75, plain.ascii = FALSE, html = TRUE, style ='grid', silent = TRUE), max.tbl.height = 300, width = 80, method = "render")

```

```{r corrplot, fig.width=19,fig.height=19}
# select numeric variables
ORIGINAL_is.numeric <- ORIGINAL %>% 
  select_if(is.numeric)

ORIGINAL_heatmap <- round(cor(ORIGINAL_is.numeric, use = "complete.obs"), 1)
ORIGINAL_heatmap <- melt(ORIGINAL_heatmap)

#  corrplot
ggplot(ORIGINAL_heatmap, aes(x=Var1, y=Var2, fill=value)) +
  geom_tile()+
  scale_fill_gradient(low = "pink", high = "dark red")+
  labs(title="Correlation Heatmap",x="", y="")+
  geom_text(aes(x=Var1, y=Var2, label=value), color="white")+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1, size = 10), plot.title = element_text(hjust=0.5, size=10))
```


